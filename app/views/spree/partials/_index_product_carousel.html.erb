<div id="index-product-carousel" class="carousel slide carousel-fade index-product-carousel" data-ride="carousel">
  <div class="carousel-inner" role="listbox">
    <div
      class="carousel-item active index-product-carousel-image background-image caption"
      style="background-image:url('<%= asset_path(products[0].images.first.attachment.url(:product)) %>')"
      data-index="0"
      >
      <%= render :partial => 'spree/partials/product_caption', locals: { product: products[0] } %>
    </div>
    <% products[1..-1].each_with_index do |p,i| %>
      <div
        class="carousel-item index-product-carousel-image background-image caption"
        style="background-image:url('<%= asset_path(p.images.first.attachment.url(:product)) %>')"
        data-index="<%= i + 1 %>"
        >
        <%= render :partial => 'spree/partials/product_caption', locals: { product: p } %>
      </div>
    <% end %>
  </div>
  <% if left %>
    <a class="left carousel-control" href="#index-store-carousel" role="button" data-slide="prev">
      <span class="sr-only">Previous</span>
    </a>
  <% else %>
    <a class="right carousel-control" href="#index-store-carousel" role="button" data-slide="next">
      <span class="sr-only">Next</span>
    </a>
  <% end %>
</div>
